import time
import pygame

if __name__ == '__main__':
    pygame.init()
    pygame.display.set_caption('Перетаскивание')
    size = width, height = 501, 501
    screen = pygame.display.set_mode(size)
    running = True
    screen2 = pygame.Surface(screen.get_size())
    x1, y1 = 250, 470
    drawing = False  # режим рисования выключен
    v = 100
    list = []
    list1 = []
    y_go = -1
    x_go = -1
    k = 0
    clock = pygame.time.Clock()
    pygame.draw.rect(screen, (255, 255, 255), (250, 470, 50, 31))
    while running:
        screen.fill(pygame.Color('black'))
        pygame.draw.rect(screen, (255, 255, 255), (x1, 470, 50, 31))
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                running = False
            if event.type == pygame.MOUSEBUTTONDOWN:
                drawing = True  # включаем режим рисования
                # запоминаем координаты одного угла
                x2, y2 = event.pos
                list1.append([-1, -1])
                list.append([x2, y2])
            if event.type == pygame.KEYUP:
                if event.key == pygame.K_a or event.key == pygame.K_LEFT:
                    x1 -= 25
                elif event.key == pygame.K_d or event.key == pygame.K_RIGHT:
                    x1 += 25
                pygame.draw.rect(screen, (255, 255, 255), (x1, 470, 50, 31))
        screen2.blit(screen, (0, 0))
        # рисуем на экране сохранённое на втором холсте
        screen.blit(screen2, (0, 0))
        s = v * clock.tick() / 1000
        if drawing:
            pygame.draw.rect(screen, (255, 255, 255), (x1, 470, 50, 31))# и, если надо, текущий прямоугольник
            for i in range(len(list)):
                pygame.draw.circle(screen, (255, 255, 255), (list[i][0], list[i][1]), 10)
                list[i][0] += s / list1[i][0]
                list[i][1] += s / list1[i][1]
                if -10 <= list[i][0] <= 10:
                    list1[i][0] = 1
                elif 501 <= list[i][0] <= 510:
                    list1[i][0] = -1
                if -10 <= list[i][1] <= 10:
                    list1[i][1] = 1
                elif 501 <= list[i][1] <= 510:
                    list1[i][1] = -1
                if 470 <= list[i][1] <= 501:
                    print(0)
                    if x1 <= list[i][0] <= x1 + 50:
                        list1[i][1] = -1
                        k += 1
                        if k == 3:
                            k = 0

                    else:
                        running = False
        screen2.blit(screen, (0, 0))
        pygame.display.flip()